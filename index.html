<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jeu Incoterms 2020 - BTS Commerce International</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            min-height: 100vh;
            padding: 20px;
            color: #fff;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        .header {
            background: linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.4);
            text-align: center;
            border: 2px solid #ff8c42;
        }

        h1 {
            color: #1a1a1a;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .subtitle {
            color: #2d2d2d;
            font-size: 1.1em;
            font-weight: 600;
        }

        .score-board {
            display: flex;
            justify-content: space-around;
            background: #2d2d2d;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 2px solid #ff6b35;
        }

        .score-item {
            text-align: center;
        }

        .score-label {
            color: #aaa;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .score-value {
            font-size: 2em;
            font-weight: bold;
            color: #ff6b35;
            text-shadow: 0 0 10px rgba(255, 107, 53, 0.5);
        }

        .game-card {
            background: #2d2d2d;
            border-radius: 15px;
            padding: 35px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            margin-bottom: 20px;
            border: 2px solid #ff6b35;
        }

        .situation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #ff6b35;
        }

        .situation-number {
            background: linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%);
            color: #1a1a1a;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }

        .question-text {
            background: #1a1a1a;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            line-height: 1.8;
            font-size: 1.05em;
            border-left: 4px solid #ff6b35;
            color: #fff;
        }

        .role-indicator {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .role-export {
            background: #ff6b35;
            color: #1a1a1a;
        }

        .role-import {
            background: #ff8c42;
            color: #1a1a1a;
        }

        .input-section {
            margin-bottom: 25px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            color: #ff8c42;
            margin-bottom: 8px;
            font-weight: 600;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ff6b35;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s;
            background: #1a1a1a;
            color: #fff;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #ff8c42;
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.2);
        }

        select option {
            background: #1a1a1a;
            color: #fff;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        button {
            flex: 1;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-submit {
            background: linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%);
            color: #1a1a1a;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }

        .btn-submit:hover {
            background: linear-gradient(135deg, #ff8c42 0%, #ffad5a 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.5);
        }

        .btn-help {
            background: #ffc107;
            color: #1a1a1a;
            box-shadow: 0 4px 15px rgba(255, 193, 7, 0.3);
        }

        .btn-help:hover {
            background: #ffcd38;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 193, 7, 0.5);
        }

        .btn-next {
            background: #28a745;
            color: white;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }

        .btn-next:hover {
            background: #34ce57;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.5);
        }

        .btn-restart {
            background: linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%);
            color: #1a1a1a;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }

        .btn-restart:hover {
            background: linear-gradient(135deg, #ff8c42 0%, #ffad5a 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.5);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .feedback {
            margin-top: 25px;
            padding: 20px;
            border-radius: 8px;
            display: none;
        }

        .feedback.show {
            display: block;
            animation: slideIn 0.5s;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .feedback-correct {
            background: #1a4d2e;
            border: 2px solid #28a745;
            color: #90ee90;
        }

        .feedback-incorrect {
            background: #4d1a1a;
            border: 2px solid #dc3545;
            color: #ffb3b3;
        }

        .feedback-help {
            background: #4d3d1a;
            border: 2px solid #ffc107;
            color: #ffe066;
        }

        .feedback-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .explanation {
            background: #1a1a1a;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            line-height: 1.6;
            color: #ddd;
        }

        .explanation strong {
            color: #ff8c42;
        }

        .help-content {
            background: #2d2d2d;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            border-left: 4px solid #ffc107;
        }

        .help-content ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .help-content li {
            margin-bottom: 8px;
        }

        .final-screen {
            text-align: center;
            padding: 40px;
        }

        .final-score {
            font-size: 4em;
            font-weight: bold;
            color: #ff6b35;
            margin: 20px 0;
            text-shadow: 0 0 20px rgba(255, 107, 53, 0.6);
        }

        .performance-message {
            font-size: 1.5em;
            margin: 20px 0;
            color: #ddd;
        }

        .badge {
            display: inline-block;
            font-size: 5em;
            margin: 20px 0;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #ff6b35;
            text-shadow: 0 0 10px rgba(255, 107, 53, 0.5);
        }

        .stat-label {
            color: #aaa;
            margin-top: 5px;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            h1 {
                font-size: 1.8em;
            }

            .button-group {
                flex-direction: column;
            }

            .score-board {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåç Jeu Incoterms 2020</h1>
            <p class="subtitle">BTS Commerce International - Ma√Ætrisez les Incoterms !</p>
        </div>

        <div class="score-board">
            <div class="score-item">
                <div class="score-label">Score</div>
                <div class="score-value" id="score">0</div>
            </div>
            <div class="score-item">
                <div class="score-label">Question</div>
                <div class="score-value"><span id="current-question">1</span>/<span id="total-questions">18</span></div>
            </div>
            <div class="score-item">
                <div class="score-label">Bonnes r√©ponses</div>
                <div class="score-value" id="correct-count">0</div>
            </div>
        </div>

        <div class="game-card" id="game-area">
            <div class="situation-header">
                <div class="situation-number">Situation <span id="question-num">1</span></div>
            </div>

            <div id="role-indicator"></div>
            <div class="question-text" id="question-text"></div>

            <div class="input-section">
                <div class="input-group">
                    <label for="incoterm-select">Incoterm √† utiliser :</label>
                    <select id="incoterm-select">
                        <option value="">-- S√©lectionnez un Incoterm --</option>
                        <option value="EXW">EXW - Ex Works</option>
                        <option value="FCA">FCA - Free Carrier</option>
                        <option value="CPT">CPT - Carriage Paid To</option>
                        <option value="CIP">CIP - Carriage and Insurance Paid To</option>
                        <option value="DAP">DAP - Delivered At Place</option>
                        <option value="DPU">DPU - Delivered at Place Unloaded</option>
                        <option value="DDP">DDP - Delivered Duty Paid</option>
                        <option value="FAS">FAS - Free Alongside Ship</option>
                        <option value="FOB">FOB - Free On Board</option>
                        <option value="CFR">CFR - Cost and Freight</option>
                        <option value="CIF">CIF - Cost Insurance and Freight</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="city-input">Ville (lieu de transfert) :</label>
                    <input type="text" id="city-input" placeholder="Ex: Montr√©al, Paris, Londres...">
                </div>
            </div>

            <div class="button-group">
                <button class="btn-submit" id="submit-btn" onclick="checkAnswer()">Valider ma r√©ponse</button>
                <button class="btn-help" id="help-btn" onclick="showHelp()">üí° Aide (-2 points)</button>
            </div>

            <div class="feedback" id="feedback"></div>

            <div class="button-group" id="next-button-container" style="display: none;">
                <button class="btn-next" onclick="nextQuestion()">Question suivante ‚Üí</button>
            </div>
        </div>

        <div class="game-card hidden" id="final-screen">
            <div class="final-screen">
                <h2>üéâ F√©licitations !</h2>
                <p>Vous avez termin√© le jeu !</p>
                <div class="final-score" id="final-score">0</div>
                <div class="badge" id="badge"></div>
                <div class="performance-message" id="performance-message"></div>
                
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-value" id="final-correct">0</div>
                        <div class="stat-label">Bonnes r√©ponses</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="final-incorrect">0</div>
                        <div class="stat-label">Erreurs</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="final-help">0</div>
                        <div class="stat-label">Aides utilis√©es</div>
                    </div>
                </div>

                <button class="btn-restart" onclick="restartGame()">üîÑ Recommencer</button>
            </div>
        </div>
    </div>

    <script>
        // Donn√©es du jeu - Situations d'Incoterms
        const situations = [
            {
                text: "Vous exportez du linge de maison au Canada. Votre client vous demande d'organiser la logistique √† vos frais jusqu'√† l'a√©roport de Montr√©al mais accepte le transfert de risques d√®s le d√©part du transport principal.",
                incoterm: "CPT",
                city: "Montr√©al",
                role: "export",
                explanation: "Le client demande que vous organisiez le transport jusqu'√† Montr√©al (donc vous payez le transport principal) ET qu'il accepte les risques d√®s le d√©part. Il s'agit du transport a√©rien multimodal. Aucune assurance n'est mentionn√©e, c'est donc CPT (Carriage Paid To) et non CIP.",
                hints: [
                    "Le client veut que vous payiez le transport jusqu'√† destination",
                    "Le transfert de risques se fait au d√©part du transport principal",
                    "C'est du transport a√©rien multimodal",
                    "Aucune assurance n'est demand√©e"
                ]
            },
            {
                text: "Vous importez du caf√© du Br√©sil par navire √† destination de Nantes. Vous souhaitez uniquement g√©rer le transport de la marchandise de l'entrep√¥t de votre transitaire localis√© √† Nantes √† votre entrep√¥t personnel, apr√®s avoir d√©douan√© la marchandise vous-m√™me et pay√© les droits de douane.",
                incoterm: "DAP",
                city: "Nantes",
                role: "import",
                explanation: "Le vendeur livre la marchandise √† Nantes, pr√™te √† √™tre d√©charg√©e. Vous g√©rez uniquement le post-acheminement local et le d√©douanement import. C'est l'incoterm DAP (Delivered At Place).",
                hints: [
                    "Le vendeur livre √† destination",
                    "Vous ne g√©rez que le transport local final",
                    "Le vendeur prend les risques jusqu'√† Nantes",
                    "L'incoterm commence par la lettre D"
                ]
            },
            {
                text: "Vous achetez des pi√®ces automobiles en Allemagne et prenez la logistique en charge, depuis les locaux de votre fournisseur, √† Karlsruhe.",
                incoterm: "EXW",
                city: "Karlsruhe",
                role: "import",
                explanation: "Vous prenez en charge toute la logistique depuis les locaux du fournisseur. C'est l'obligation minimale du vendeur : EXW (Ex Works).",
                hints: [
                    "Vous g√©rez tout depuis l'usine du fournisseur",
                    "Le vendeur a l'obligation minimale",
                    "Le transfert se fait dans les locaux du vendeur",
                    "C'est l'incoterm avec le moins d'obligations pour le vendeur"
                ]
            },
            {
                text: "Vous exportez, votre client s√©n√©galais vous demande d'organiser le transport maritime jusqu'au port de Dakar et de souscrire une assurance pour son compte. Il accepte le transfert de risque depuis le d√©part du transport principal.",
                incoterm: "CIP",
                city: "Dakar",
                role: "export",
                explanation: "Transport maritime avec marchandise conteneuris√©e, vous organisez jusqu'√† Dakar, vous prenez l'assurance, mais le transfert de risques se fait au d√©part. C'est CIP (Carriage and Insurance Paid to) car l'assurance est demand√©e et le transport est multimodal.",
                hints: [
                    "Le client demande une assurance",
                    "Vous organisez et payez le transport jusqu'√† destination",
                    "Le transfert de risques se fait au d√©part",
                    "C'est un incoterm de la famille 'C' avec assurance"
                ]
            },
            {
                text: "Vous exportez des t√¥les en vrac par voie maritime √† destination d'Alger (Alg√©rie). Vous voulez bien conclure le contrat de transport principal et assumer les frais mais sans autre d√©marche.",
                incoterm: "CFR",
                city: "Alger",
                role: "export",
                explanation: "Transport maritime de marchandises en vrac, vous payez le transport jusqu'√† Alger mais sans assurance ni risques au-del√† du d√©part. C'est CFR (Cost and Freight), exclusivement maritime pour marchandises non conteneuris√©es.",
                hints: [
                    "C'est du transport maritime en vrac",
                    "Vous payez le transport mais pas l'assurance",
                    "Le transfert de risques se fait au d√©part",
                    "C'est un incoterm exclusivement maritime de la famille 'C'"
                ]
            },
            {
                text: "Vous importez et r√©cup√©rez vos marchandises non assur√©es et non conteneuris√©es, au port d'Anvers, en Belgique, et en organisez le d√©chargement et le post-acheminement par route jusqu'√† vos locaux, √† Lille.",
                incoterm: "CFR",
                city: "Anvers",
                role: "import",
                explanation: "Marchandises maritimes non conteneuris√©es et non assur√©es livr√©es au port d'Anvers. Le vendeur a pay√© le transport maritime. C'est CFR (Cost and Freight).",
                hints: [
                    "Marchandises non conteneuris√©es et non assur√©es",
                    "Transport maritime uniquement",
                    "Le vendeur a pay√© le fret jusqu'au port de destination",
                    "C'est un incoterm maritime de la famille 'C' sans assurance"
                ]
            },
            {
                text: "Vous exportez un conteneur complet de marchandises par la voie maritime. Votre client prendra en charge la logistique depuis le port de Fos-Marseille. La marchandise sera prise en charge dans le camion de pr√©-acheminement. Vous avez r√©alis√© le d√©douanement export.",
                incoterm: "FCA",
                city: "Fos-Marseille",
                role: "export",
                explanation: "Vous livrez la marchandise conteneuris√©e au transporteur d√©sign√© par l'acheteur au port de Fos-Marseille apr√®s d√©douanement export. C'est FCA (Free Carrier).",
                hints: [
                    "Vous livrez au transporteur du client",
                    "Le transfert se fait lors de la remise au transporteur",
                    "Vous faites le d√©douanement export",
                    "C'est un incoterm de la famille 'F'"
                ]
            },
            {
                text: "Votre fournisseur a organis√© le transport de vos marchandises, √† vos risques, jusqu'√† l'a√©roport de Lyon. Vous importez.",
                incoterm: "CPT",
                city: "Lyon",
                role: "import",
                explanation: "Le vendeur a pay√© le transport jusqu'√† Lyon mais vous assumez les risques depuis le d√©part. Sans mention d'assurance, c'est CPT (Carriage Paid To).",
                hints: [
                    "Le vendeur paie le transport jusqu'√† destination",
                    "Vous assumez les risques depuis le d√©part",
                    "Pas d'assurance mentionn√©e",
                    "C'est un incoterm multimodal de la famille 'C'"
                ]
            },
            {
                text: "Votre entreprise se trouve √† Montpellier, vous chargez la marchandise emball√©e dans le camion du transporteur routier d√©sign√© par votre client britannique apr√®s avoir r√©alis√© le d√©douanement export.",
                incoterm: "FCA",
                city: "Montpellier",
                role: "export",
                explanation: "Vous remettez la marchandise au transporteur du client √† Montpellier apr√®s d√©douanement export. C'est FCA (Free Carrier).",
                hints: [
                    "Vous remettez au transporteur du client",
                    "Le transfert se fait dans vos locaux/ville",
                    "Vous g√©rez le d√©douanement export",
                    "C'est un incoterm de la famille 'F'"
                ]
            },
            {
                text: "Vous importez de Chine des moteurs emball√©s dans des caisses en bois conteneuris√©es par bateau √† destination de Tours. Port de d√©barquement : Le Havre. L'exportateur doit conclure le contrat de transport, assurance comprise, c'est vous qui assumez les risques depuis le port de d√©part.",
                incoterm: "CIP",
                city: "Le Havre",
                role: "import",
                explanation: "Transport maritime avec marchandise conteneuris√©e, le vendeur paie transport et assurance jusqu'au Havre, mais vous assumez les risques d√®s le d√©part en Chine. C'est CIP (Carriage and Insurance Paid to).",
                hints: [
                    "Marchandise conteneuris√©e en transport maritime",
                    "Le vendeur paie transport ET assurance",
                    "Vous assumez les risques d√®s le d√©part",
                    "C'est un incoterm multimodal de la famille 'C' avec assurance"
                ]
            },
            {
                text: "Vous livrez un client en Su√®de et organisez toute la logistique, √† vos risques, par avion puis par route, jusqu'√† ses locaux √† Malm√∂. La marchandise est prise en charge encore charg√©e dans le camion.",
                incoterm: "DAP",
                city: "Malm√∂",
                role: "export",
                explanation: "Vous organisez et payez tout le transport jusqu'aux locaux du client √† Malm√∂ et assumez tous les risques. La marchandise est livr√©e charg√©e dans le camion. C'est DAP (Delivered At Place).",
                hints: [
                    "Vous g√©rez tout jusqu'√† destination",
                    "Vous assumez tous les risques",
                    "Livraison aux locaux du client",
                    "C'est un incoterm de la famille 'D'"
                ]
            },
            {
                text: "Vous exportez par bateau de la marchandise √† destination de Sa√Øgon (Vi√™t-Nam). Votre client vous demande simplement d'assurer le pr√©-acheminement de la marchandise jusqu'au quai d'embarquement au port de Marseille, ainsi que le d√©douanement export.",
                incoterm: "FAS",
                city: "Marseille",
                role: "export",
                explanation: "Vous livrez la marchandise le long du navire au port de Marseille apr√®s d√©douanement export. C'est FAS (Free Alongside Ship), un incoterm exclusivement maritime.",
                hints: [
                    "Livraison le long du navire",
                    "Transport maritime uniquement",
                    "Vous g√©rez jusqu'au quai d'embarquement",
                    "C'est un incoterm maritime de la famille 'F'"
                ]
            },
            // NOUVELLES SITUATIONS ENRICHIES
            {
                text: "Vous exportez des machines-outils par bateau vers le Mexique. Votre client mexicain prend en charge le transport maritime et l'assurance d√®s que la marchandise est charg√©e sur le navire au port de Marseille. Vous g√©rez le pr√©-acheminement et le d√©douanement export.",
                incoterm: "FOB",
                city: "Marseille",
                role: "export",
                explanation: "Le transfert des risques et des frais se fait d√®s que la marchandise est charg√©e sur le bateau au port de Marseille. C'est FOB (Free On Board), un incoterm exclusivement maritime.",
                hints: [
                    "Transport maritime uniquement",
                    "Le transfert se fait au chargement sur le navire",
                    "Port dans le pays de l'exportateur",
                    "C'est un incoterm de la famille 'F' maritime"
                ]
            },
            {
                text: "Vous exportez du mat√©riel agricole lourd vers la Pologne. Votre client vous demande de livrer l'√©quipement √† son entrep√¥t √† Varsovie et de le d√©charger vous-m√™me avec votre grue car il n'a pas l'√©quipement n√©cessaire. Vous organisez tout le transport et assumez tous les risques jusqu'au d√©chargement.",
                incoterm: "DPU",
                city: "Varsovie",
                role: "export",
                explanation: "Vous livrez √† destination ET vous d√©chargez la marchandise. DPU (Delivered at Place Unloaded) est le seul incoterm o√π le vendeur a l'obligation de d√©charger la marchandise au lieu de destination.",
                hints: [
                    "Vous livrez √† destination",
                    "Vous devez d√©charger la marchandise",
                    "C'est le seul incoterm avec obligation de d√©chargement pour le vendeur",
                    "C'est un incoterm de la famille 'D'"
                ]
            },
            {
                text: "Vous exportez des produits cosm√©tiques vers la Suisse. Votre client suisse vous demande de livrer la marchandise directement √† son magasin √† Gen√®ve, de g√©rer vous-m√™me le d√©douanement import suisse et de payer les droits de douane et la TVA. Il prendra en charge uniquement le d√©chargement.",
                incoterm: "DDP",
                city: "Gen√®ve",
                role: "export",
                explanation: "Vous livrez √† destination et g√©rez le d√©douanement import ainsi que le paiement des droits et taxes. C'est DDP (Delivered Duty Paid), l'incoterm avec le maximum d'obligations pour le vendeur.",
                hints: [
                    "Vous livrez √† destination",
                    "Vous g√©rez le d√©douanement import",
                    "Vous payez les droits de douane et taxes",
                    "C'est l'incoterm avec le plus d'obligations pour le vendeur"
                ]
            },
            {
                text: "Vous exportez du minerai de fer en vrac par bateau vers la Chine. Votre client chinois vous demande d'organiser le transport maritime jusqu'au port de Shanghai et de souscrire une assurance pour son compte. Le transfert de risques se fait d√®s le chargement de la marchandise sur le navire √† Marseille.",
                incoterm: "CIF",
                city: "Shanghai",
                role: "export",
                explanation: "Marchandise en vrac (non conteneuris√©e) en transport maritime, vous organisez le transport et l'assurance, mais le transfert de risques se fait au port de d√©part. C'est CIF (Cost Insurance Freight), exclusivement maritime pour marchandises en vrac ou non conteneuris√©es.",
                hints: [
                    "Marchandise en vrac (non conteneuris√©e)",
                    "Transport maritime exclusivement",
                    "Vous devez souscrire une assurance",
                    "Le transfert de risques se fait au port de d√©part"
                ]
            },
            {
                text: "Vous importez du caf√© en grains du Vietnam par bateau. Votre fournisseur organise le transport maritime non conteneuris√© jusqu'au port du Havre et souscrit une assurance pour votre compte. Vous assumez les risques d√®s le port de d√©part au Vietnam. Vous g√©rez le d√©chargement et le post-acheminement.",
                incoterm: "CIF",
                city: "Le Havre",
                role: "import",
                explanation: "Transport maritime de marchandise non conteneuris√©e avec assurance souscrite par le vendeur, mais vous assumez les risques depuis le port de d√©part. C'est CIF (Cost Insurance Freight).",
                hints: [
                    "Marchandise non conteneuris√©e",
                    "Transport maritime avec assurance",
                    "Vous assumez les risques depuis le d√©part",
                    "C'est un incoterm maritime de la famille 'C' avec assurance"
                ]
            },
            {
                text: "Vous importez des smartphones de Cor√©e du Sud. Le fournisseur livre la marchandise dans votre entrep√¥t √† Lyon, la d√©charge lui-m√™me et assume tous les risques jusqu'au d√©chargement complet. Vous g√©rez uniquement le d√©douanement import.",
                incoterm: "DPU",
                city: "Lyon",
                role: "import",
                explanation: "Le vendeur livre √† destination, d√©charge la marchandise et assume les risques jusqu'au d√©chargement. C'est DPU (Delivered at Place Unloaded).",
                hints: [
                    "Le vendeur livre √† destination",
                    "Il d√©charge la marchandise",
                    "Vous ne g√©rez que le d√©douanement import",
                    "C'est le seul incoterm o√π le vendeur d√©charge"
                ]
            },
            {
                text: "Vous exportez des composants √©lectroniques par bateau vers Singapour. Votre client asiatique organise lui-m√™me le transport maritime principal. Vous vous chargez uniquement de livrer la marchandise charg√©e sur le navire au port de Marseille apr√®s avoir effectu√© le d√©douanement export.",
                incoterm: "FOB",
                city: "Marseille",
                role: "export",
                explanation: "Vous livrez la marchandise charg√©e sur le navire au port de Marseille. Le transfert de risques et de frais se fait √† ce moment. C'est FOB (Free On Board), exclusivement maritime.",
                hints: [
                    "Transport maritime",
                    "Vous livrez sur le navire",
                    "Le client g√®re le transport maritime principal",
                    "Le transfert se fait au chargement sur le navire"
                ]
            },
            {
                text: "Vous importez des meubles d'Italie. Votre fournisseur italien livre les marchandises directement dans votre magasin √† Nice, g√®re le d√©douanement import en France et paie tous les droits de douane. Vous n'avez qu'√† d√©charger les meubles du camion.",
                incoterm: "DDP",
                city: "Nice",
                role: "import",
                explanation: "Le vendeur livre √† destination, g√®re le d√©douanement import et paie les droits. C'est l'obligation maximale pour le vendeur : DDP (Delivered Duty Paid).",
                hints: [
                    "Le vendeur livre √† destination",
                    "Il g√®re le d√©douanement import",
                    "Il paie les droits et taxes",
                    "Vous n'avez qu'√† d√©charger"
                ]
            },
            {
                text: "Votre entreprise √† Lille exporte des textiles vers le Royaume-Uni. Le transporteur d√©sign√© par votre client britannique vient r√©cup√©rer un conteneur complet dans vos locaux. Vous chargez le conteneur dans son camion et effectuez les formalit√©s de d√©douanement export.",
                incoterm: "FCA",
                city: "Lille",
                role: "export",
                explanation: "Vous remettez le conteneur au transporteur du client dans vos locaux √† Lille apr√®s d√©douanement export. C'est FCA (Free Carrier).",
                hints: [
                    "Le transporteur est d√©sign√© par le client",
                    "Vous remettez dans vos locaux",
                    "Vous faites le d√©douanement export",
                    "C'est un incoterm de la famille 'F'"
                ]
            },
            {
                text: "Vous exportez des c√©r√©ales en vrac par navire vers le Maroc. Vous organisez le transport maritime jusqu'au port de Casablanca mais votre client marocain assume les risques d√®s le chargement sur le navire en France et g√®re lui-m√™me son assurance.",
                incoterm: "CFR",
                city: "Casablanca",
                role: "export",
                explanation: "Marchandise en vrac (non conteneuris√©e), transport maritime, vous payez le fret mais pas l'assurance, et le client assume les risques d√®s le d√©part. C'est CFR (Cost and Freight).",
                hints: [
                    "Marchandise en vrac",
                    "Transport maritime exclusivement",
                    "Vous payez le fret mais pas l'assurance",
                    "Le transfert de risques se fait au port de d√©part"
                ]
            },
            {
                text: "Vous achetez du mat√©riel informatique d'un fournisseur allemand √† Munich. Vous envoyez votre propre transporteur r√©cup√©rer la marchandise directement dans l'usine du fournisseur. Le fournisseur met simplement la marchandise √† disposition, vous g√©rez tout le reste y compris le chargement.",
                incoterm: "EXW",
                city: "Munich",
                role: "import",
                explanation: "Vous prenez en charge absolument tout depuis l'usine du fournisseur, y compris le chargement. C'est EXW (Ex Works), l'incoterm avec le minimum d'obligations pour le vendeur.",
                hints: [
                    "Vous g√©rez tout depuis l'usine",
                    "Le vendeur met juste √† disposition",
                    "Vous g√©rez m√™me le chargement",
                    "C'est l'incoterm avec le moins d'obligations pour le vendeur"
                ]
            },
            {
                text: "Vous exportez des vins de Bordeaux vers les √âtats-Unis par conteneur maritime. Votre client am√©ricain vous demande d'organiser le transport jusqu'au port de New York et de souscrire une assurance maritime pour son compte. Il accepte d'assumer les risques d√®s le d√©part de France.",
                incoterm: "CIP",
                city: "New York",
                role: "export",
                explanation: "Transport maritime avec marchandise conteneuris√©e (vin en conteneur), vous organisez le transport et l'assurance, mais le transfert de risques se fait au d√©part. C'est CIP car conteneuris√© et avec assurance demand√©e.",
                hints: [
                    "Marchandise conteneuris√©e en maritime",
                    "Assurance demand√©e par le client",
                    "Vous organisez et payez le transport principal",
                    "Le transfert de risques se fait au d√©part"
                ]
            },
            {
                text: "Vous exportez des √©quipements √©lectroniques conteneuris√©s par voie maritime vers Tokyo (Japon). Votre client japonais souhaite que vous organisiez le transport jusqu'au port de Tokyo et que vous souscriviez une assurance pour son compte, mais il accepte d'assumer les risques d√®s le d√©part du navire en France.",
                incoterm: "CIP",
                city: "Tokyo",
                role: "export",
                explanation: "Transport maritime avec marchandise conteneuris√©e, vous organisez et payez le transport jusqu'√† Tokyo et souscrivez l'assurance, mais le transfert de risques se fait au d√©part du transport principal. C'est CIP car c'est conteneuris√© et l'assurance est demand√©e.",
                hints: [
                    "Marchandise conteneuris√©e",
                    "Assurance demand√©e par le client",
                    "Vous payez le transport jusqu'√† destination",
                    "Le transfert de risques se fait au d√©part du transport principal"
                ]
            },
            {
                text: "Votre entreprise bas√©e √† Bordeaux importe du vin argentin. Le fournisseur organise et paie le transport a√©rien jusqu'√† l'a√©roport de Paris-CDG, mais vous assumez tous les risques depuis Buenos Aires. Aucune assurance n'est souscrite par le vendeur.",
                incoterm: "CPT",
                city: "Paris-CDG",
                role: "import",
                explanation: "Le vendeur paie le transport a√©rien jusqu'√† Paris-CDG mais vous assumez les risques depuis le d√©part. Sans assurance demand√©e, c'est CPT (Carriage Paid To), un incoterm multimodal.",
                hints: [
                    "Transport a√©rien (multimodal)",
                    "Le vendeur paie le transport jusqu'√† destination",
                    "Vous assumez les risques depuis le d√©part",
                    "Pas d'assurance souscrite par le vendeur"
                ]
            },
            {
                text: "Vous importez du textile du Bangladesh. Votre fournisseur vous livre la marchandise non conteneuris√©e par bateau au port du Havre. Il a organis√© et pay√© le transport maritime mais n'a pas souscrit d'assurance. Vous g√©rez le d√©chargement et le post-acheminement vers vos entrep√¥ts √† Rouen.",
                incoterm: "CFR",
                city: "Le Havre",
                role: "import",
                explanation: "Marchandise non conteneuris√©e en transport maritime, le vendeur a pay√© le fret jusqu'au Havre mais sans assurance. C'est CFR (Cost and Freight), exclusivement maritime pour marchandises en vrac ou non conteneuris√©es.",
                hints: [
                    "Marchandise non conteneuris√©e",
                    "Transport maritime uniquement",
                    "Le vendeur a pay√© le fret maritime",
                    "Pas d'assurance souscrite"
                ]
            },
            {
                text: "Vous exportez des machines industrielles vers le Maroc. Votre client marocain prend en charge toute la logistique depuis vos locaux √† Lyon. Il envoie son propre transporteur r√©cup√©rer la marchandise. Vous n'effectuez m√™me pas le chargement sur le camion.",
                incoterm: "EXW",
                city: "Lyon",
                role: "export",
                explanation: "Le client g√®re absolument tout depuis vos locaux √† Lyon, vous n'effectuez m√™me pas le chargement. C'est l'obligation minimale du vendeur : EXW (Ex Works).",
                hints: [
                    "Le client g√®re tout depuis vos locaux",
                    "Vous n'avez aucune obligation de chargement",
                    "C'est l'incoterm avec le minimum d'obligations pour le vendeur",
                    "Le transfert se fait dans vos locaux"
                ]
            },
            {
                text: "Vous exportez des pi√®ces d√©tach√©es automobiles par transport routier vers l'Espagne. Votre client espagnol a d√©sign√© un transporteur qui vient r√©cup√©rer la marchandise dans vos locaux √† Toulouse. Vous chargez les marchandises dans son camion et effectuez le d√©douanement export.",
                incoterm: "FCA",
                city: "Toulouse",
                role: "export",
                explanation: "Vous remettez la marchandise au transporteur d√©sign√© par le client √† Toulouse, apr√®s l'avoir charg√©e et d√©douan√©e √† l'export. C'est FCA (Free Carrier).",
                hints: [
                    "Vous remettez au transporteur du client",
                    "Vous effectuez le chargement et le d√©douanement export",
                    "Le transfert se fait lors de la remise au transporteur",
                    "C'est un incoterm de la famille 'F'"
                ]
            },
            {
                text: "Vous exportez des c√©r√©ales en vrac par bateau vers l'√âgypte. Vous organisez le transport maritime jusqu'au port d'Alexandrie et en assumez les co√ªts, mais votre client √©gyptien assume les risques d√®s que la marchandise est charg√©e sur le navire en France. Vous ne souscrivez pas d'assurance.",
                incoterm: "CFR",
                city: "Alexandrie",
                role: "export",
                explanation: "Marchandise en vrac (non conteneuris√©e) en transport maritime, vous payez le fret jusqu'√† Alexandrie mais le client assume les risques d√®s le chargement sur le navire. Sans assurance, c'est CFR (Cost and Freight).",
                hints: [
                    "Marchandise en vrac (non conteneuris√©e)",
                    "Transport maritime exclusivement",
                    "Vous payez le fret mais pas l'assurance",
                    "Le transfert de risques se fait au chargement sur le navire"
                ]
            },
            {
                text: "Vous importez des meubles de Pologne par transport routier. Votre fournisseur polonais livre la marchandise directement dans votre entrep√¥t √† Strasbourg, pr√™te √† √™tre d√©charg√©e. Il assume tous les risques et co√ªts jusqu'√† ce point, mais vous g√©rez le d√©douanement import et payez les droits de douane.",
                incoterm: "DAP",
                city: "Strasbourg",
                role: "import",
                explanation: "Le vendeur livre √† destination (Strasbourg), pr√™t √† √™tre d√©charg√©, et assume tous les risques et co√ªts jusqu'√† ce point. Vous g√©rez le d√©douanement import. C'est DAP (Delivered At Place).",
                hints: [
                    "Le vendeur livre √† destination",
                    "Il assume tous les risques jusqu'√† votre entrep√¥t",
                    "Vous ne g√©rez que le d√©douanement import",
                    "C'est un incoterm de la famille 'D'"
                ]
            },
            {
                text: "Vous exportez des produits chimiques conteneuris√©s par bateau vers le Br√©sil. Votre client br√©silien vous demande d'organiser le transport maritime jusqu'au port de Santos et de souscrire une assurance pour son compte. Il accepte que les risques soient transf√©r√©s d√®s le chargement du conteneur sur le navire en France.",
                incoterm: "CIP",
                city: "Santos",
                role: "export",
                explanation: "Transport maritime avec marchandise conteneuris√©e, vous organisez le transport jusqu'√† Santos et souscrivez l'assurance pour le client, mais le transfert de risques se fait au d√©part du transport principal. C'est CIP (Carriage and Insurance Paid to) car conteneuris√© et avec assurance.",
                hints: [
                    "Marchandise conteneuris√©e en maritime",
                    "Assurance souscrite pour le compte du client",
                    "Vous organisez et payez le transport principal",
                    "Le transfert de risques se fait au d√©part"
                ]
            }
        ];

        // Variables de jeu
        let currentQuestionIndex = 0;
        let score = 0;
        let correctAnswers = 0;
        let incorrectAnswers = 0;
        let helpUsed = 0;
        let shuffledQuestions = [];
        let helpShown = false;

        // Initialisation du jeu
        function initGame() {
            // M√©langer les questions
            shuffledQuestions = [...situations].sort(() => Math.random() - 0.5);
            currentQuestionIndex = 0;
            score = 0;
            correctAnswers = 0;
            incorrectAnswers = 0;
            helpUsed = 0;
            
            document.getElementById('total-questions').textContent = shuffledQuestions.length;
            loadQuestion();
        }

        // Charger une question
        function loadQuestion() {
            helpShown = false;
            const situation = shuffledQuestions[currentQuestionIndex];
            
            document.getElementById('question-num').textContent = currentQuestionIndex + 1;
            document.getElementById('current-question').textContent = currentQuestionIndex + 1;
            document.getElementById('question-text').textContent = situation.text;
            
            // Afficher le r√¥le (import/export)
            const roleDiv = document.getElementById('role-indicator');
            if (situation.role === 'export') {
                roleDiv.innerHTML = '<span class="role-indicator role-export">üëâ Vous √™tes EXPORTATEUR</span>';
            } else {
                roleDiv.innerHTML = '<span class="role-indicator role-import">üëâ Vous √™tes IMPORTATEUR</span>';
            }
            
            // R√©initialiser les champs
            document.getElementById('incoterm-select').value = '';
            document.getElementById('city-input').value = '';
            document.getElementById('feedback').classList.remove('show');
            document.getElementById('feedback').innerHTML = '';
            document.getElementById('next-button-container').style.display = 'none';
            document.getElementById('submit-btn').disabled = false;
            document.getElementById('help-btn').disabled = false;
        }

        // Normaliser une cha√Æne (enlever accents, espaces, casse)
        function normalizeString(str) {
            return str.toLowerCase()
                .normalize('NFD')
                .replace(/[\u0300-\u036f]/g, '')
                .replace(/[^a-z0-9]/g, '');
        }

        // V√©rifier la r√©ponse
        function checkAnswer() {
            const situation = shuffledQuestions[currentQuestionIndex];
            const selectedIncoterm = document.getElementById('incoterm-select').value;
            const enteredCity = document.getElementById('city-input').value.trim();
            
            if (!selectedIncoterm || !enteredCity) {
                alert('‚ö†Ô∏è Veuillez s√©lectionner un Incoterm et entrer une ville !');
                return;
            }
            
            const feedbackDiv = document.getElementById('feedback');
            const normalizedEnteredCity = normalizeString(enteredCity);
            const normalizedCorrectCity = normalizeString(situation.city);
            
            const incotermCorrect = selectedIncoterm === situation.incoterm;
            const cityCorrect = normalizedEnteredCity === normalizedCorrectCity;
            
            document.getElementById('submit-btn').disabled = true;
            document.getElementById('help-btn').disabled = true;
            
            if (incotermCorrect && cityCorrect) {
                // R√©ponse correcte
                const points = helpShown ? 3 : 5;
                score += points;
                correctAnswers++;
                
                feedbackDiv.className = 'feedback feedback-correct show';
                feedbackDiv.innerHTML = `
                    <div class="feedback-title">‚úÖ Excellente r√©ponse !</div>
                    <p>Vous avez gagn√© <strong>${points} points</strong> !</p>
                    <div class="explanation">
                        <strong>Explication :</strong><br>
                        ${situation.explanation}
                    </div>
                `;
            } else {
                // R√©ponse incorrecte
                score -= 3;
                incorrectAnswers++;
                
                let errorMsg = '';
                if (!incotermCorrect && !cityCorrect) {
                    errorMsg = `L'Incoterm correct est <strong>${situation.incoterm}</strong> et la ville est <strong>${situation.city}</strong>.`;
                } else if (!incotermCorrect) {
                    errorMsg = `La ville est correcte mais l'Incoterm correct est <strong>${situation.incoterm}</strong>.`;
                } else {
                    errorMsg = `L'Incoterm est correct mais la ville correcte est <strong>${situation.city}</strong>.`;
                }
                
                feedbackDiv.className = 'feedback feedback-incorrect show';
                feedbackDiv.innerHTML = `
                    <div class="feedback-title">‚ùå R√©ponse incorrecte</div>
                    <p>Vous perdez <strong>3 points</strong>.</p>
                    <p>${errorMsg}</p>
                    <div class="explanation">
                        <strong>Explication :</strong><br>
                        ${situation.explanation}
                    </div>
                `;
            }
            
            updateScoreDisplay();
            document.getElementById('next-button-container').style.display = 'block';
        }

        // Afficher l'aide
        function showHelp() {
            helpShown = true;
            helpUsed++;
            score -= 2;
            
            const situation = shuffledQuestions[currentQuestionIndex];
            const feedbackDiv = document.getElementById('feedback');
            
            feedbackDiv.className = 'feedback feedback-help show';
            feedbackDiv.innerHTML = `
                <div class="feedback-title">üí° Aide activ√©e (-2 points)</div>
                <div class="help-content">
                    <strong>Indices pour vous aider :</strong>
                    <ul>
                        ${situation.hints.map(hint => `<li>${hint}</li>`).join('')}
                    </ul>
                </div>
            `;
            
            document.getElementById('help-btn').disabled = true;
            updateScoreDisplay();
        }

        // Mettre √† jour l'affichage du score
        function updateScoreDisplay() {
            document.getElementById('score').textContent = score;
            document.getElementById('correct-count').textContent = correctAnswers;
        }

        // Question suivante
        function nextQuestion() {
            currentQuestionIndex++;
            
            if (currentQuestionIndex < shuffledQuestions.length) {
                loadQuestion();
            } else {
                showFinalScreen();
            }
        }

        // Afficher l'√©cran final
        function showFinalScreen() {
            document.getElementById('game-area').classList.add('hidden');
            document.getElementById('final-screen').classList.remove('hidden');
            
            document.getElementById('final-score').textContent = score;
            document.getElementById('final-correct').textContent = correctAnswers;
            document.getElementById('final-incorrect').textContent = incorrectAnswers;
            document.getElementById('final-help').textContent = helpUsed;
            
            // D√©terminer la performance
            const percentage = (correctAnswers / shuffledQuestions.length) * 100;
            let badge = '';
            let message = '';
            
            if (percentage >= 90) {
                badge = 'üèÜ';
                message = 'Expert en Incoterms ! Performance exceptionnelle !';
            } else if (percentage >= 75) {
                badge = 'ü•á';
                message = 'Tr√®s bon travail ! Vous ma√Ætrisez bien les Incoterms !';
            } else if (percentage >= 60) {
                badge = 'ü•à';
                message = 'Bon niveau ! Continuez √† vous entra√Æner !';
            } else if (percentage >= 40) {
                badge = 'ü•â';
                message = 'Pas mal ! Revoyez certains concepts et r√©essayez !';
            } else {
                badge = 'üìö';
                message = 'Il faut r√©viser les Incoterms. Courage !';
            }
            
            document.getElementById('badge').textContent = badge;
            document.getElementById('performance-message').textContent = message;
        }

        // Recommencer le jeu
        function restartGame() {
            document.getElementById('game-area').classList.remove('hidden');
            document.getElementById('final-screen').classList.add('hidden');
            initGame();
        }

        // D√©marrer le jeu au chargement de la page
        window.onload = initGame;
    </script>
</body>
</html>